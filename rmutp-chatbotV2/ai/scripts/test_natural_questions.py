"""
‡∏ó‡∏î‡∏™‡∏≠‡∏ö AI ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÅ‡∏ö‡∏ö‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥
‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà user ‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏à‡∏∞‡∏ñ‡∏≤‡∏°
"""

import requests
import json

# ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà user ‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ñ‡∏≤‡∏° (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡∏£‡∏á‡πÜ)
NATURAL_QUESTIONS = [
    # Admission (‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£)
    ("‡∏≠‡∏¢‡∏≤‡∏Å‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏¢‡∏±‡∏á‡πÑ‡∏á", "ask_admission"),
    ("‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà", "ask_admission"),
    ("‡∏ú‡∏°‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏ß‡∏¥‡∏®‡∏ß‡∏∞ ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏≠‡∏ö‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á", "ask_admission"),
    
    # Student Loans (‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤)
    ("‡∏°‡∏µ‡∏ó‡∏∏‡∏ô‡πÉ‡∏´‡πâ‡πÑ‡∏´‡∏° ‡∏ú‡∏°‡∏¢‡∏≤‡∏Å‡∏à‡∏±‡∏á", "ask_loan"),
    ("‡∏ú‡∏°‡∏à‡∏∞‡∏¢‡∏∑‡πà‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Å‡∏π‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà", "ask_loan"),
    ("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏π‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏ó‡∏≥‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏î‡∏µ", "ask_loan"),
    
    # Tuition (‡∏Ñ‡πà‡∏≤‡πÄ‡∏ó‡∏≠‡∏°)
    ("‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡πÄ‡∏ó‡∏≠‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà", "ask_tuition"),
    ("‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡πÅ‡∏û‡∏á‡πÑ‡∏´‡∏°", "ask_tuition"),
    ("‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏°‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö", "ask_tuition"),
    
    # Grade (‡πÄ‡∏Å‡∏£‡∏î)
    ("‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Å‡∏£‡∏î‡∏ó‡∏≥‡πÑ‡∏á‡∏Ñ‡∏£‡∏±‡∏ö", "ask_grade"),
    ("‡∏ñ‡πâ‡∏≤‡∏™‡∏≠‡∏ö‡∏ï‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏¢‡∏±‡∏á‡πÑ‡∏á", "ask_grade"),
    ("‡∏î‡∏π‡∏ú‡∏•‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á", "ask_grade"),
    
    # Department (‡∏™‡∏≤‡∏Ç‡∏≤)
    ("‡∏™‡∏≤‡∏Ç‡∏≤‡∏Ñ‡∏≠‡∏°‡∏°‡∏µ‡∏Å‡∏µ‡πà‡∏Ñ‡∏ô", "ask_department"),
    ("‡∏ß‡∏¥‡∏®‡∏ß‡∏∞‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á", "ask_department"),
    ("‡∏°‡∏µ‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡∏™‡∏≠‡∏ô‡∏Å‡∏µ‡πà‡∏Ñ‡∏ô", "ask_department"),
    
    # Facility (‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å)
    ("‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πá‡∏ö‡∏°‡∏µ‡∏Ñ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏´‡∏°", "ask_facility"),
    ("‡∏°‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏î‡∏£‡∏ñ‡πÑ‡∏´‡∏°", "ask_facility"),
    
    # Contact (‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠)
    ("‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô", "ask_contact"),
    ("‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏Ñ‡∏ì‡∏∞‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà", "ask_contact"),
    
    # News (‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£)
    ("‡∏°‡∏µ‡∏Ç‡πà‡∏≤‡∏ß‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ", "ask_news"),
    ("‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏´‡∏°", "ask_news"),
]

def test_natural_questions():
    print("=" * 80)
    print("‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÅ‡∏ö‡∏ö‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ (Natural Questions Test)")
    print("=" * 80)
    print()
    
    correct = 0
    total = len(NATURAL_QUESTIONS)
    
    for i, (question, expected_intent) in enumerate(NATURAL_QUESTIONS, 1):
        try:
            response = requests.post(
                'http://localhost:5000/predict',
                json={'question': question},
                timeout=3
            )
            result = response.json()
            
            intent = result.get('intent', 'N/A')
            confidence = result.get('confidence', 0)
            method = result.get('method', 'N/A')
            
            is_correct = (intent == expected_intent)
            if is_correct:
                correct += 1
            
            # ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
            status = "‚úÖ" if is_correct else "‚ùå"
            print(f"{i:2d}. {status} \"{question}\"")
            print(f"    ‚Üí ‡πÑ‡∏î‡πâ: {intent} ({confidence:.1%}) [{method}]")
            if not is_correct:
                print(f"    ‚Üí ‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ: {expected_intent}")
            print()
            
        except requests.exceptions.ConnectionError:
            print(f"{i}. ‚ùå \"{question}\"")
            print("    ERROR: API ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î API ‡∏Å‡πà‡∏≠‡∏ô")
            print("    ‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á: run_api_server.bat")
            return
        except Exception as e:
            print(f"{i}. ‚ùå \"{question}\"")
            print(f"    ERROR: {str(e)}")
            print()
    
    # ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•
    print("=" * 80)
    print("üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö")
    print("=" * 80)
    accuracy = (correct / total) * 100
    print(f"‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: {correct}/{total}")
    print(f"‚ùå ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {total - correct}/{total}")
    print(f"üéØ Accuracy: {accuracy:.1f}%")
    print()
    
    if accuracy >= 90:
        print("üéâ ‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! AI ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å")
    elif accuracy >= 70:
        print("üëç ‡∏î‡∏µ! AI ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ")
    elif accuracy >= 50:
        print("‚ö†Ô∏è  ‡∏û‡∏≠‡πÉ‡∏ä‡πâ ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á")
    else:
        print("‚ùå ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á AI ‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô")

if __name__ == '__main__':
    test_natural_questions()
